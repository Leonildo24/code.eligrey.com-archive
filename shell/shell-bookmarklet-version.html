<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>JavaScript Shell Extended</title><script type="text/javascript" id="inputEval">function line1EvalShellInput() { _win.eval("try{ Shell.printAnswer(eval('with(Shell._scope) with(Shell.shellCommands) { eval(Shell.question) }')); } catch(er) { Shell.printError(er); }; setTimeout(Shell.refocus, 0);") }</script>
<script type="text/javascript">
//<![CDATA[

if(typeof JSON=="undefined"){eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('3(!l.m){m={}}(5(){5 f(n){7 n<10?"0"+n:n}3(6 V.q.p!=="5"){V.q.p=5(a){7 l.1o()+"-"+f(l.1p()+1)+"-"+f(l.1q())+"T"+f(l.1r())+":"+f(l.1s())+":"+f(l.1t())+"Z"};L.q.p=1u.q.p=1v.q.p=5(a){7 l.1w()}}w e=/[\\1x\\W\\X-\\Y\\11\\12\\13\\14-\\15\\17-\\18\\19-\\1a\\1b\\1c-\\1d]/g,G=/[\\\\\\"\\1y-\\1z\\1A-\\1B\\W\\X-\\Y\\11\\12\\13\\14-\\15\\17-\\18\\19-\\1a\\1b\\1c-\\1d]/g,8,y,1e={"\\b":"\\\\b","\\t":"\\\\t","\\n":"\\\\n","\\f":"\\\\f","\\r":"\\\\r",\'"\':\'\\\\"\',"\\\\":"\\\\\\\\"},o;5 H(b){G.1f=0;7 G.M(b)?\'"\'+b.z(G,5(a){w c=1e[a];7 6 c==="I"?c:"\\\\u"+("1g"+a.1h(0).N(16)).1i(-4)})+\'"\':\'"\'+b+\'"\'}5 A(a,b){w i,k,v,h,B=8,9,2=b[a];3(2&&6 2==="x"&&6 2.p==="5"){2=2.p(a)}3(6 o==="5"){2=o.J(b,a,2)}1C(6 2){C"I":7 H(2);C"O":7 1D(2)?L(2):"D";C"1E":C"D":7 L(2);C"x":3(!2){7"D"}8+=y;9=[];3(P.q.N.1F(2)==="[x 1G]"){h=2.h;E(i=0;i<h;i+=1){9[i]=A(i,2)||"D"}v=9.h===0?"[]":8?"[\\n"+8+9.K(",\\n"+8)+"\\n"+B+"]":"["+9.K(",")+"]";8=B;7 v}3(o&&6 o==="x"){h=o.h;E(i=0;i<h;i+=1){k=o[i];3(6 k==="I"){v=A(k,2);3(v){9.1j(H(k)+(8?": ":":")+v)}}}}Q{E(k 1k 2){3(P.1l.J(2,k)){v=A(k,2);3(v){9.1j(H(k)+(8?": ":":")+v)}}}}v=9.h===0?"{}":8?"{\\n"+8+9.K(",\\n"+8)+"\\n"+B+"}":"{"+9.K(",")+"}";8=B;7 v}}3(6 m.R!=="5"){m.R=5(a,b,c){w i;8="";y="";3(6 c==="O"){E(i=0;i<c;i+=1){y+=" "}}Q{3(6 c==="I"){y=c}}o=b;3(b&&6 b!=="5"&&(6 b!=="x"||6 b.h!=="O")){1m 1n 1H("m.R")}7 A("",{"":a})}}3(6 m.S!=="5"){m.S=5(c,d){w j;5 U(a,b){w k,v,2=a[b];3(2&&6 2==="x"){E(k 1k 2){3(P.1l.J(2,k)){v=U(2,k);3(v!==1I){2[k]=v}Q{1J 2[k]}}}}7 d.J(a,b,2)}e.1f=0;3(e.M(c)){c=c.z(e,5(a){7"\\\\u"+("1g"+a.1h(0).N(16)).1i(-4)})}3(/^[\\],:{}\\s]*$/.M(c.z(/\\\\(?:["\\\\\\/1K]|u[0-1L-1M-F]{4})/g,"@").z(/"[^"\\\\\\n\\r]*"|1N|1O|D|-?\\d+(?:\\.\\d*)?(?:[1P][+\\-]?\\d+)?/g,"]").z(/(?:^|:|,)(?:\\s*\\[)+/g,""))){j=1Q("("+c+")");7 6 d==="5"?U({"":j},""):j}1m 1n 1R("m.S")}}})();',62,116,'||value|if||function|typeof|return|gap|partial||||||||length||||this|JSON||rep|toJSON|prototype||||||var|object|indent|replace|str|mind|case|null|for||escapable|quote|string|call|join|String|test|toString|number|Object|else|stringify|parse||walk|Date|u00ad|u0600|u0604|||u070f|u17b4|u17b5|u200c|u200f||u2028|u202f|u2060|u206f|ufeff|ufff0|uffff|meta|lastIndex|0000|charCodeAt|slice|push|in|hasOwnProperty|throw|new|getUTCFullYear|getUTCMonth|getUTCDate|getUTCHours|getUTCMinutes|getUTCSeconds|Number|Boolean|valueOf|u0000|x00|x1f|x7f|x9f|switch|isFinite|boolean|apply|Array|Error|undefined|delete|bfnrt|9a|fA|true|false|eE|eval|SyntaxError'.split('|'),0,{}));}
var
histList=[""],histPos=0,_scope={},_win,question,_in,_out,tooManyMatches=null,lastError=null;function _JS_version_check(start,end){var scripts=[];if(typeof start=="undefined")var start=_JS_version_check.start;if(typeof end=="undefined")var end=_JS_version_check.end;for(var i=start;i<=end;i++){var s=document.createElement("script");s.type="application/javascript;version="+parseFloat((i/10).toFixed(1)).toString();s.src="data:application/javascript,"+encodeURIComponent(_JS_version_check.code+";\nvar JavaScript_version = "+parseFloat((i/10).toFixed(1)).toString());document.getElementsByTagName("head")[0].appendChild(s);scripts.push(s);}
for(var i=0;i<scripts.length;i++){document.getElementsByTagName("head")[0].removeChild(scripts[i]);}}
_JS_version_check.start=10;_JS_version_check.end=20;_JS_version_check.code=document.getElementById("inputEval").innerHTML;_JS_version_check();function refocus(){_in.blur();_in.focus();}
function init(){_in=document.getElementById("input");_out=document.getElementById("output");_win=window;if(opener&&!opener.closed){println("Using bookmarklet version of shell: commands will run in opener's context.","message");_win=opener;}
initTarget();recalculateInputHeight();refocus();}
function initTarget(){_win.Shell=window;_win.print=shellCommands.print;}
function keepFocusInTextbox(e){var g=false;if(typeof e.target!="undefined"){g=e.target;}
else if(typeof e.srcElement!="undefined"){g=e.srcElement;}
if(g){while(!g.tagName)
g=g.parentNode;var t=g.tagName.toUpperCase();if(t=="A"||t=="INPUT")
return;if(window.getSelection){if(String(window.getSelection()))
return;}
else if(document.getSelection){if(document.getSelection())
return;}
else{if(document.selection.createRange().text)
return;}}
refocus();}
function inputKeydown(e){if(e.shiftKey&&e.keyCode==13){}else if(e.keyCode==13){try{go();}catch(er){alert(er);};setTimeout(function(){_in.value="";},0);}else if(e.keyCode==38){if(e.ctrlKey||caretInFirstLine(_in))
hist(true);}else if(e.keyCode==40){if(e.ctrlKey||caretInLastLine(_in))
hist(false);}else if(e.keyCode==9){tabcomplete();setTimeout(function(){refocus();},0);}else{}
setTimeout(recalculateInputHeight,0);};function caretInFirstLine(textbox){if(textbox.selectionStart==undefined)
return true;var firstLineBreak=textbox.value.indexOf("\n");return((firstLineBreak==-1)||(textbox.selectionStart<=firstLineBreak));}
function caretInLastLine(textbox){if(textbox.selectionEnd==undefined)
return true;var lastLineBreak=textbox.value.lastIndexOf("\n");return(textbox.selectionEnd>lastLineBreak);}
function recalculateInputHeight(){var rows=_in.value.split(/\n/).length
+1
+(window.opera?1:0);if(_in.rows!=rows)
_in.rows=rows;}
function println(s,type){if((s=String(s))){var newdiv=document.createElement("div");newdiv.appendChild(document.createTextNode(s));newdiv.className=type;_out.appendChild(newdiv);return newdiv;}}
function printWithRunin(h,s,type){var div=println(s,type);var head=document.createElement("strong");head.appendChild(document.createTextNode(h+": "));div.insertBefore(head,div.firstChild);}
var shellCommands={load:function load(uri,printLoadMsg,forcedVersion){if(typeof printLoadMsg=="undefined")printLoadMsg=true;if(Object.prototype.toString.call(uri)=="[object Array]"){for(var i=0,len=uri.length; i < len; i++){load(uri[i],false,forcedVersion);};if(printLoadMsg)println("Loading "+uri.join(", ")+"...","message");return;}
var s=_win.document.createElement("script");s.type="text/javascript";if(typeof forcedVersion=="number")s.type+=";version="+forcedVersion.toString();else if(typeof JavaScript_version!="undefined"&&typeof forcedVersion=="undefined")s.type+=";version="+JavaScript_version.toString();s.src=uri;_win.document.getElementsByTagName("head")[0].appendChild(s);if(printLoadMsg)println("Loading "+uri+"...","message");},clear:function clear(){while(_out.childNodes[0])
_out.removeChild(_out.childNodes[0]);},print:function print(){println(Array.prototype.slice.call(arguments).join(" "),"print");},pr:function pr(s){shellCommands.print(s);return s;},props:function props(e,onePerLine){if(e===null){println("props called with null argument","error");return;}
if(e===undefined){println("props called with undefined argument","error");return;}
var ns=["Methods","Fields","Unreachables"];var as=[[],[],[]];var p,j,i;var protoLevels=0;for(p=e;p;p=p.__proto__){for(i=0;i<ns.length;++i)
as[i][protoLevels]=[];++protoLevels;}
for(var a in e){var protoLevel=-1;try
{for(p=e;p&&(a in p);p=p.__proto__)
++protoLevel;}
catch(er){protoLevel=0;}
var type=1;try{if((typeof e[a])=="function")
type=0;}
catch(er){type=2;}
as[type][protoLevel].push(a);}
function times(s,n){return n?s+times(s,n-1):"";}
for(j=0;j<protoLevels;++j)
for(i=0;i<ns.length;++i)
if(as[i][j].length)
printWithRunin(ns[i]+times(" of prototype",j),(onePerLine?"\n\n":"")+as[i][j].sort().join(onePerLine?"\n":", ")+(onePerLine?"\n\n":""),"propList");},blink:function blink(node){if(!node)throw("blink: argument is null or undefined.");if(node.nodeType==null)throw("blink: argument must be a node.");if(node.nodeType==3)throw("blink: argument must not be a text node");if(node.documentElement)throw("blink: argument must not be the document object");function setOutline(o){return function(){if(node.style.outline!=node.style.bogusProperty){node.style.outline=o;}
else if(node.style.MozOutline!=node.style.bogusProperty){node.style.MozOutline=o;}
else{node.style.border=o;}}}
function focusIt(a){return function(){a.focus();}}
if(node.ownerDocument){var windowToFocusNow=(node.ownerDocument.defaultView||node.ownerDocument.parentWindow);if(windowToFocusNow)
setTimeout(focusIt(windowToFocusNow.top),0);}
for(var i=1;i<7;++i)
setTimeout(setOutline((i%2)?'3px solid red':'none'),i*100);setTimeout(focusIt(window),800);setTimeout(focusIt(_in),810);},scope:function scope(sc){if(!sc)sc={};_scope=sc;println("Scope is now "+sc+".  If a variable is not found in this scope, window will also be searched.  New variables will still go on window.","message");},mathHelp:function mathHelp(){printWithRunin("Math constants","E, LN2, LN10, LOG2E, LOG10E, PI, SQRT1_2, SQRT2","propList");printWithRunin("Math methods","abs, acos, asin, atan, atan2, ceil, cos, exp, floor, log, max, min, pow, random, round, sin, sqrt, tan","propList");},ans:undefined};function hist(up){var L=histList.length;if(L==1)
return;if(up){if(histPos==L-1){histList[histPos]=_in.value;}
if(histPos>0){histPos--;setTimeout(function(){_in.value='';_in.value=histList[histPos];var caretPos=_in.value.length;if(_in.setSelectionRange)
_in.setSelectionRange(caretPos,caretPos);},0);}}
else{if(histPos<L-1){histPos++;_in.value=histList[histPos];}
else if(histPos==L-1){if(_in.value){histList[histPos]=_in.value;++histPos;_in.value="";}}}}
function tabcomplete(){function findbeginning(s,from,stopAtDot){function equalButNotEscaped(s,i,q){if(s.charAt(i)!=q)
return false;if(i==0)
return true;if(s.charAt(i-1)=='\\')
return false;return true;}
var nparens=0;var i;for(i=from;i>=0;i--){if(s.charAt(i)==' ')
break;if(stopAtDot&&s.charAt(i)=='.')
break;if(s.charAt(i)==')')
nparens++;else if(s.charAt(i)=='(')
nparens--;if(nparens<0)
break;if(s.charAt(i)=='\''||s.charAt(i)=='\"'){var quot=s.charAt(i);i--;while(i>=0&&!equalButNotEscaped(s,i,quot)){i--;}}}
return i;}
function getcaretpos(inp){if(inp.selectionEnd!=null)
return inp.selectionEnd;if(inp.createTextRange){var docrange=_win.Shell.document.selection.createRange();var inprange=inp.createTextRange();if(inprange.setEndPoint)
{inprange.setEndPoint('EndToStart',docrange);return inprange.text.length;}}
return inp.value.length;}
function setselectionto(inp,pos){if(inp.selectionStart){inp.selectionStart=inp.selectionEnd=pos;}
else if(inp.createTextRange){var docrange=_win.Shell.document.selection.createRange();var inprange=inp.createTextRange();inprange.move('character',pos);inprange.select();}
else{}}
var caret=getcaretpos(_in);if(caret){var dotpos,spacepos,complete,obj;dotpos=findbeginning(_in.value,caret-1,true);if(dotpos==-1||_in.value.charAt(dotpos)!='.'){dotpos=caret;}
spacepos=findbeginning(_in.value,dotpos-1,false);if(spacepos==dotpos||spacepos+1==dotpos||dotpos==caret){if(_in.value.charAt(dotpos)=='('||(_in.value.charAt(spacepos)=='('&&(spacepos+1)==dotpos))
{var fn,fname;var from=(_in.value.charAt(dotpos)=='(')?dotpos:spacepos;spacepos=findbeginning(_in.value,from-1,false);fname=_in.value.substr(spacepos+1,from-(spacepos+1));try{with(_win.Shell._scope)
with(_win)
with(Shell.shellCommands)
fn=eval(fname);}
catch(er){return;}
if(fn==undefined){return;}
if(fn instanceof Function){if(!fn.toString().match(/function .+?\(\) +\{\n +\[native code\]\n\}/))
println(fn.toString().match(/function .+?\(.*?\)/),"tabcomplete");}
return;}
else
obj=_win;}
else{var objname=_in.value.substr(spacepos+1,dotpos-(spacepos+1));try{with(_win.Shell._scope)
with(_win)
obj=eval(objname);}
catch(er){printError(er);return;}
if(obj==undefined){return;}}
if(dotpos==caret){if(spacepos+1==dotpos||spacepos==dotpos){return;}
complete=_in.value.substr(spacepos+1,dotpos-(spacepos+1));}
else{complete=_in.value.substr(dotpos+1,caret-(dotpos+1));}
var matches=[];var bestmatch=null;for(var a in obj){if(a.substr(0,complete.length)==complete){matches.push(a);if(bestmatch==null){bestmatch=a;}
else{function min(a,b){return((a<b)?a:b);}
var i;for(i=0;i<min(bestmatch.length,a.length);i++){if(bestmatch.charAt(i)!=a.charAt(i))
break;}
bestmatch=bestmatch.substr(0,i);}}}
bestmatch=(bestmatch||"");var objAndComplete=(objname||obj)+"."+bestmatch;if(matches.length>1&&(tooManyMatches==objAndComplete||matches.length<=10)){printWithRunin("Matches: ",matches.join(', '),"tabcomplete");tooManyMatches=null;}
else if(matches.length>10){println(matches.length+" matches.  Press tab again to see them all","tabcomplete");tooManyMatches=objAndComplete;}
else{tooManyMatches=null;}
if(bestmatch!=""){var sstart;if(dotpos==caret){sstart=spacepos+1;}
else{sstart=dotpos+1;}
_in.value=_in.value.substr(0,sstart)
+bestmatch
+_in.value.substr(caret);setselectionto(_in,caret+(bestmatch.length-complete.length));}}}
function printQuestion(q){println(q,"input");}
function printAnswer(a){if(a!==undefined){println(a,"normalOutput");shellCommands.ans=a;}}
function printError(er){var lineNumberString;lastError=er;if(er.name)
{lineNumberString=(er.lineNumber!=undefined)?(" on line "+er.lineNumber+": "):": ";println(er.name+lineNumberString+er.message,"error");}
else
println(er,"error");}
function go(s){_in.value=question=s?s:_in.value;if(question=="")
return;histList[histList.length-1]=question;histList[histList.length]="";histPos=histList.length-1;_in.value='';recalculateInputHeight();printQuestion(question);if(_win.closed){printError("Target window has been closed.");return;}
try{("Shell"in _win)}
catch(er){printError("The JavaScript Shell cannot access variables in the target window.  The most likely reason is that the target window now has a different page loaded and that page has a different hostname than the original page.");return;}
if(!("Shell"in _win))
initTarget();line1EvalShellInput();}
if(typeof console!="object")var console={};if(typeof console.log!="function"&&typeof print=="function")console.log=function(){Shell.shellCommands.print.apply(this,Array.prototype.slice.call(arguments))}
window.onload=init;document.onclick=function(e){keepFocusInTextbox(e)};
//]]>
</script>

<style type="text/css">
body { background: white; color: black; }

#output { white-space: pre; white-space: -moz-pre-wrap; } /* Preserve line breaks, but wrap too if browser supports it */
h3 { margin-top: 0; margin-bottom: 0em; }
h3 + div { margin: 0; }

form { margin: 0; padding: 0; }
#input { width: 100%; border: none; padding: 0; overflow: auto; }

.input { color: blue; background: white; font: inherit; font-weight: bold; margin-top: .5em; /* background: #E6E6FF; */ }
.normalOutput { color: black; background: white; }
.print { color: brown; background: white; }
.error { color: red; background: white; }
.propList { color: green; background: white; }
.message { color: green; background: white; }
.tabcomplete { color: purple; background: white; }
</style>
</head>

<body>

<h3>JavaScript Shell Extended</h3>
<div>Features: autocompletion of property names with Tab, multiline input with Shift+Enter, input history with (Ctrl+) Up/Down, <a accesskey="M" href="#" onclick="go('scope(Math); mathHelp();');return false;" title="Accesskey: M">Math</a>, <a accesskey="H" href="http://code.eligrey.com/shell/help.html" title="Accesskey: H">help</a></div><div>Values and functions: ans, print(string), <a accesskey="P" href="#" onclick="go('props(ans)');return false;" title="Accesskey: P">props(object)</a>, <a accesskey="B" href="#" onclick="go('blink(ans)');return false" title="Accesskey: B">blink(node)</a>, <a accesskey="C" href="#" onclick="go('clear()');return false;" title="Accesskey: C">clear()</a>, load(scriptURL), scope(object), JSON.parse(JSON string), <a accesskey="J" href="#" onclick="go('JSON.stringify(ans)');return false;" title="Accesskey: J">JSON.stringify(object)</a></div>
<div id="output"></div>

<div><textarea id="input" class="input" wrap="off" onkeydown="inputKeydown(event)" rows="1"></textarea></div>
</body>
</html>
